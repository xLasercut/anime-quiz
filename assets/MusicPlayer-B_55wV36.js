import{d as M,r as d,Q as C,c as T,e as $,h as p,w as r,f as u,g as k,T as R,U as x,W as G,l as L,t as V,X as Y,a as H,i as B,I as z,u as F,Y as Q,o as W,Z as X,m as c,$ as Z,a0 as w,a1 as J,L as j,k as K,a2 as _,a3 as h,a4 as ee,a5 as D,a6 as q,V as te}from"./index-BkCMYhQt.js";const ne=M({__name:"MusicPlayerTablePlayerControls",props:{duration:{required:!0,type:Number},currentTime:{required:!0,type:Number},playing:{required:!0,type:Boolean},shuffle:{required:!0,type:Boolean}},emits:["seek","previous","play","pause","next","update:shuffle"],setup(m,{emit:y}){const v=m,f=d(v.currentTime),s=d(!1);C(()=>v.currentTime,a=>{s.value||(f.value=a)});function o(a){return a<3600?new Date(a*1e3).toISOString().substring(14,19):new Date(a*1e3).toISOString().substring(11,16)}return(a,l)=>($(),T(p,null,{default:r(()=>[u(k,{justify:"center"},{default:r(()=>[u(p,{cols:"auto"},{default:r(()=>[u(x,{icon:"mdi-skip-backward",variant:"flat",color:"primary",onClick:l[0]||(l[0]=i=>a.$emit("previous"))})]),_:1}),m.playing?R("",!0):($(),T(p,{key:0,cols:"auto"},{default:r(()=>[u(x,{icon:"mdi-play",variant:"flat",color:"success",onClick:l[1]||(l[1]=i=>a.$emit("play"))})]),_:1})),m.playing?($(),T(p,{key:1,cols:"auto"},{default:r(()=>[u(x,{icon:"mdi-pause",variant:"flat",color:"warning",onClick:l[2]||(l[2]=i=>a.$emit("pause"))})]),_:1})):R("",!0),u(p,{cols:"auto"},{default:r(()=>[u(x,{icon:"mdi-skip-forward",variant:"flat",color:"primary",onClick:l[3]||(l[3]=i=>a.$emit("next"))})]),_:1})]),_:1}),u(k,{justify:"center"},{default:r(()=>[u(p,{cols:"10"},{default:r(()=>[u(G,{min:0,max:m.duration,"model-value":f.value,onMousedown:l[4]||(l[4]=i=>s.value=!0),onMouseup:l[5]||(l[5]=i=>s.value=!1),"hide-details":!0,"thumb-label":!0,"thumb-size":20,color:"warning",onEnd:l[6]||(l[6]=i=>a.$emit("seek",i))},{"thumb-label":r(({modelValue:i})=>[L(V(o(i)),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1}),u(k,{justify:"center"},{default:r(()=>[L(V(o(m.currentTime))+" / "+V(o(m.duration)),1)]),_:1}),u(k,{justify:"center"},{default:r(()=>[u(p,{cols:"auto"},{default:r(()=>[u(Y,{"true-icon":"mdi-shuffle","false-icon":"mdi-shuffle-disabled",color:"info","base-color":"primary",density:"compact","model-value":m.shuffle,"onUpdate:modelValue":l[7]||(l[7]=i=>a.$emit("update:shuffle",i))},null,8,["model-value"])]),_:1})]),_:1})]),_:1}))}}),ae={class:"music-player-container"},le=["src","currentTime","volume","muted"],ue=M({__name:"MusicPlayerTablePlayer",props:{song:{required:!0,type:Object},shuffle:{required:!0,type:Boolean}},emits:["next","previous","play","set-initial-song","update:shuffle"],setup(m,{emit:y}){const v=m,f=y,s=H(),o=d(null),a=d(0),l=d(-1),i=d(!1),g=d(!1),S=d(s.volume),P=d(!1);C(()=>s.volume,t=>{S.value=t}),C(()=>g.value,t=>{t&&f("next")});async function b(){o.value.play(),setTimeout(()=>{P.value=!0,S.value=s.volume,P.value=!1},0)}function E(){return s.audioOnly&&v.song.audioSrc?v.song.audioSrc:v.song.src}function N(t){a.value=t.detail.currentTime}function A(t){l.value=t.detail}function U(){v.song.songId?o.value.play():f("set-initial-song")}function O(){o.value.pause()}return(t,e)=>($(),T(k,{dense:!0},{default:r(()=>[u(p,{cols:"auto"},{default:r(()=>[B("div",ae,[B("media-player",{ref_key:"player",ref:o,autoplay:!1,src:E(),currentTime:a.value,onPause:e[0]||(e[0]=n=>i.value=!1),volume:S.value/1e4,onPlay:e[1]||(e[1]=n=>i.value=!0),onEnded:e[2]||(e[2]=n=>g.value=!0),onSourceChange:e[3]||(e[3]=n=>g.value=!1),onTimeUpdate:e[4]||(e[4]=n=>N(n)),onDurationChange:e[5]||(e[5]=n=>A(n)),load:"eager",onCanPlay:b,muted:P.value},e[12]||(e[12]=[B("media-provider",null,null,-1)]),40,le)])]),_:1}),u(ne,{onSeek:e[6]||(e[6]=n=>a.value=n),"current-time":a.value,duration:l.value,onPause:e[7]||(e[7]=n=>O()),onPlay:e[8]||(e[8]=n=>U()),playing:i.value,onNext:e[9]||(e[9]=n=>t.$emit("next")),onPrevious:e[10]||(e[10]=n=>t.$emit("previous")),shuffle:m.shuffle,"onUpdate:shuffle":e[11]||(e[11]=n=>t.$emit("update:shuffle",n))},null,8,["current-time","duration","playing","shuffle"])]),_:1}))}}),ie=z(ue,[["__scopeId","data-v-aaecb32c"]]),re=M({__name:"MusicPlayerTable",setup(m){const y=F(),v=[{title:"Anime",key:"animeName",sortable:!1},{title:"Title",key:"songTitle",sortable:!1},{title:"Artist",key:"artist",sortable:!1},{title:"Type",key:"type",sortable:!1},{title:"Action",key:"action",sortable:!1,width:"60px"}],{currentPage:f,itemsPerPage:s}=Q(j.MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE),o=d({songId:"",src:"",type:q.OP,songTitle:"",artist:"",animeName:[],animeId:[],audioSrc:""}),a=d({anime:"",title:"",artist:"",type:Object.values(q)}),l=d(!0),i=d([]);C(()=>o.value,t=>{const e=i.value.indexOf(t);f.value=Math.floor(e/s.value)+1}),C(()=>[a.value.anime,a.value.title,a.value.artist,a.value.type],()=>{g()});function g(){i.value=y.songList.filter(t=>y.userSongList.includes(t.songId)&&D(a.value.anime,t.animeName.join(","))&&D(a.value.title,t.songTitle)&&D(a.value.artist,t.artist)&&a.value.type.includes(t.type))}function S(t){return o.value.songId===t.songId}function P(t){return S(t)?"primary":"success"}function b(t){const e=Math.floor(Math.random()*t.length);return t[e]}function E(t){if(l.value)return b(t);const e=t.indexOf(o.value);return e>=t.length-1?t[0]:t[e+1]}function N(t){if(l.value)return b(t);const e=t.indexOf(o.value);return e<=0?t[t.length-1]:t[e-1]}function A(){const t=i.value;t.length<=0||(o.value=E(t))}function U(){const t=i.value;t.length<=0||(o.value=N(t))}function O(){const t=i.value;if(!(t.length<=0)){if(l.value){o.value=b(t);return}o.value=t[0]}}return W(()=>{g()}),(t,e)=>($(),T(X,{headers:v,items:i.value,"fixed-header":!0,"fixed-footer":!0,density:"compact",page:c(f),"onUpdate:page":e[10]||(e[10]=n=>w(f)?f.value=n:null),"items-per-page":c(s),height:c(Z).MUSIC_PLAYER_TABLE_HEIGHT,"no-filter":!0},{"item.animeName":r(({item:n})=>[u(ee,{song:n},null,8,["song"])]),"item.action":r(({item:n})=>[u(h,{icon:"mdi-play-box",color:P(n),onClick:I=>o.value=n,disabled:S(n)},null,8,["color","onClick","disabled"])]),top:r(()=>[u(K,{fluid:!0},{default:r(()=>[u(ie,{song:o.value,onNext:e[0]||(e[0]=n=>A()),onPrevious:e[1]||(e[1]=n=>U()),onSetInitialSong:e[2]||(e[2]=n=>O()),shuffle:l.value,"onUpdate:shuffle":e[3]||(e[3]=n=>l.value=n)},null,8,["song","shuffle"]),u(_,{anime:a.value.anime,"onUpdate:anime":e[4]||(e[4]=n=>a.value.anime=n),animeModifiers:{trim:!0},title:a.value.title,"onUpdate:title":e[5]||(e[5]=n=>a.value.title=n),titleModifiers:{trim:!0},artist:a.value.artist,"onUpdate:artist":e[6]||(e[6]=n=>a.value.artist=n),artistModifiers:{trim:!0},type:a.value.type,"onUpdate:type":e[7]||(e[7]=n=>a.value.type=n),typeModifiers:{trim:!0}},null,8,["anime","title","artist","type"])]),_:1})]),bottom:r(({pageCount:n})=>[u(J,{"current-page":c(f),"onUpdate:currentPage":e[8]||(e[8]=I=>w(f)?f.value=I:null),"items-per-page":c(s),"onUpdate:itemsPerPage":e[9]||(e[9]=I=>w(s)?s.value=I:null),length:n,"local-storage-key":c(j).MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE},null,8,["current-page","items-per-page","length","local-storage-key"])]),_:1},8,["items","page","items-per-page","height"]))}}),se=M({__name:"MusicPlayer",setup(m){return(y,v)=>($(),T(te,{variant:"flat"},{default:r(()=>[u(re)]),_:1}))}});export{se as default};
