import{d as N,r as g,Q as E,e as P,c as b,w as o,f as u,h as S,T as M,U as R,g as C,W as G,l as L,t as V,X as Y,a as _,p as D,m as c,Y as H,Z as z,I as F,u as Q,$ as W,a0 as j,o as X,a1 as Z,a2 as J,a3 as K,k as h,a4 as w,L as q,a5 as ee,a6 as te,a7 as ne,a8 as B,V as ae}from"./index-_X-1-tHp.js";const le=N({__name:"MusicPlayerTablePlayerControls",props:{duration:{required:!0,type:Number},currentTime:{required:!0,type:Number},playing:{required:!0,type:Boolean},shuffle:{required:!0,type:Boolean}},emits:["seek","previous","play","pause","next","update:shuffle"],setup(f,{emit:T}){const y=f,m=g(y.currentTime),p=g(!1);E(()=>y.currentTime,t=>{p.value||(m.value=t)});function s(t){return t<3600?new Date(t*1e3).toISOString().substring(14,19):new Date(t*1e3).toISOString().substring(11,16)}return(t,l)=>(P(),b(S,null,{default:o(()=>[u(C,{justify:"center"},{default:o(()=>[u(S,{cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-skip-backward",variant:"flat",color:"primary",onClick:l[0]||(l[0]=i=>t.$emit("previous"))})]),_:1}),f.playing?R("",!0):(P(),b(S,{key:0,cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-play",variant:"flat",color:"success",onClick:l[1]||(l[1]=i=>t.$emit("play"))})]),_:1})),f.playing?(P(),b(S,{key:1,cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-pause",variant:"flat",color:"warning",onClick:l[2]||(l[2]=i=>t.$emit("pause"))})]),_:1})):R("",!0),u(S,{cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-skip-forward",variant:"flat",color:"primary",onClick:l[3]||(l[3]=i=>t.$emit("next"))})]),_:1})]),_:1}),u(C,{justify:"center"},{default:o(()=>[u(S,{cols:"10"},{default:o(()=>[u(G,{min:0,max:f.duration,"model-value":m.value,onMousedown:l[4]||(l[4]=i=>p.value=!0),onMouseup:l[5]||(l[5]=i=>p.value=!1),"hide-details":!0,"thumb-label":!0,"thumb-size":20,color:"warning",onEnd:l[6]||(l[6]=i=>t.$emit("seek",i))},{"thumb-label":o(({modelValue:i})=>[L(V(s(i)),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1}),u(C,{justify:"center"},{default:o(()=>[L(V(s(f.currentTime))+" / "+V(s(f.duration)),1)]),_:1}),u(C,{justify:"center"},{default:o(()=>[u(S,{cols:"auto"},{default:o(()=>[u(Y,{"true-icon":"mdi-shuffle","false-icon":"mdi-shuffle-disabled",color:"info","base-color":"primary",density:"compact","model-value":f.shuffle,"onUpdate:modelValue":l[7]||(l[7]=i=>t.$emit("update:shuffle",i))},null,8,["model-value"])]),_:1})]),_:1})]),_:1}))}}),ue=f=>(H("data-v-2a38658e"),f=f(),z(),f),ie={class:"music-player-container"},re=["src","currentTime","volume"],oe=ue(()=>D("media-provider",null,null,-1)),se=[oe],de=N({__name:"MusicPlayerTablePlayer",props:{song:{required:!0,type:Object},shuffle:{required:!0,type:Boolean}},emits:["next","previous","play","set-initial-song","update:shuffle"],setup(f,{emit:T}){const y=f,m=T,p=_(),s=g(null),t=g(0),l=g(-1),i=g(!1),$=g(!1);E(()=>$.value,v=>{v&&m("next")});function I(){return p.audioOnly&&y.song.audioSrc?y.song.audioSrc:y.song.src}function A(v){t.value=v.detail.currentTime}function k(v){l.value=v.detail}function U(){y.song.songId?s.value.play():m("set-initial-song")}function O(){s.value.pause()}return(v,a)=>(P(),b(C,{dense:!0},{default:o(()=>[u(S,{cols:"auto"},{default:o(()=>[D("div",ie,[D("media-player",{ref_key:"player",ref:s,autoplay:"",src:I(),currentTime:t.value,onPause:a[0]||(a[0]=d=>i.value=!1),onPlay:a[1]||(a[1]=d=>i.value=!0),volume:c(p).volume/100,onEnded:a[2]||(a[2]=d=>$.value=!0),onSourceChange:a[3]||(a[3]=d=>$.value=!1),onTimeUpdate:a[4]||(a[4]=d=>A(d)),onDurationChange:a[5]||(a[5]=d=>k(d)),load:"eager"},se,40,re)])]),_:1}),u(le,{onSeek:a[6]||(a[6]=d=>t.value=d),"current-time":t.value,duration:l.value,onPause:a[7]||(a[7]=d=>O()),onPlay:a[8]||(a[8]=d=>U()),playing:i.value,onNext:a[9]||(a[9]=d=>v.$emit("next")),onPrevious:a[10]||(a[10]=d=>v.$emit("previous")),shuffle:f.shuffle,"onUpdate:shuffle":a[11]||(a[11]=d=>v.$emit("update:shuffle",d))},null,8,["current-time","duration","playing","shuffle"])]),_:1}))}}),fe=F(de,[["__scopeId","data-v-2a38658e"]]),me=N({__name:"MusicPlayerTable",setup(f){const T=Q(),y=[{title:"Anime",key:"animeName",sortable:!1},{title:"Title",key:"songTitle",sortable:!1},{title:"Artist",key:"artist",sortable:!1},{title:"Type",key:"type",sortable:!1},{title:"Action",key:"action",sortable:!1,width:"60px"}],{currentPage:m,itemsPerPage:p}=W(q.MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE),s=g({songId:"",src:"",type:j.OP,songTitle:"",artist:"",animeName:[],animeId:[],audioSrc:""}),t=g({anime:"",title:"",artist:"",type:Object.values(j)}),l=g(!0),i=g([]);E(()=>s.value,e=>{const n=i.value.indexOf(e);m.value=Math.floor(n/p.value)+1}),E(()=>[t.value.anime,t.value.title,t.value.artist,t.value.type],()=>{$()});function $(){i.value=T.songList.filter(e=>T.userSongList.includes(e.songId)&&B(t.value.anime,e.animeName.join(","))&&B(t.value.title,e.songTitle)&&B(t.value.artist,e.artist)&&t.value.type.includes(e.type))}function I(e){return s.value.songId===e.songId}function A(e){return I(e)?"primary":"success"}function k(e){const n=Math.floor(Math.random()*e.length);return e[n]}function U(e){if(l.value)return k(e);const n=e.indexOf(s.value);return n>=e.length-1?e[0]:e[n+1]}function O(e){if(l.value)return k(e);const n=e.indexOf(s.value);return n<=0?e[e.length-1]:e[n-1]}function v(){const e=i.value;e.length<=0||(s.value=U(e))}function a(){const e=i.value;e.length<=0||(s.value=O(e))}function d(){const e=i.value;if(!(e.length<=0)){if(l.value){s.value=k(e);return}s.value=e[0]}}return X(()=>{$()}),(e,n)=>(P(),b(ne,{headers:y,items:i.value,"fixed-header":!0,"fixed-footer":!0,density:"compact",page:c(m),"onUpdate:page":n[10]||(n[10]=r=>w(m)?m.value=r:null),"items-per-page":c(p),height:c(te).MUSIC_PLAYER_TABLE_HEIGHT,"no-filter":!0},{"item.animeName":o(({item:r})=>[u(Z,{song:r},null,8,["song"])]),"item.action":o(({item:r})=>[u(J,{icon:"mdi-play-box",color:A(r),onClick:x=>s.value=r,disabled:I(r)},null,8,["color","onClick","disabled"])]),top:o(()=>[u(h,{fluid:!0},{default:o(()=>[u(fe,{song:s.value,onNext:n[0]||(n[0]=r=>v()),onPrevious:n[1]||(n[1]=r=>a()),onSetInitialSong:n[2]||(n[2]=r=>d()),shuffle:l.value,"onUpdate:shuffle":n[3]||(n[3]=r=>l.value=r)},null,8,["song","shuffle"]),u(K,{anime:t.value.anime,"onUpdate:anime":n[4]||(n[4]=r=>t.value.anime=r),animeModifiers:{trim:!0},title:t.value.title,"onUpdate:title":n[5]||(n[5]=r=>t.value.title=r),titleModifiers:{trim:!0},artist:t.value.artist,"onUpdate:artist":n[6]||(n[6]=r=>t.value.artist=r),artistModifiers:{trim:!0},type:t.value.type,"onUpdate:type":n[7]||(n[7]=r=>t.value.type=r),typeModifiers:{trim:!0}},null,8,["anime","title","artist","type"])]),_:1})]),bottom:o(({pageCount:r})=>[u(ee,{"current-page":c(m),"onUpdate:currentPage":n[8]||(n[8]=x=>w(m)?m.value=x:null),"items-per-page":c(p),"onUpdate:itemsPerPage":n[9]||(n[9]=x=>w(p)?p.value=x:null),length:r,"local-storage-key":c(q).MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE},null,8,["current-page","items-per-page","length","local-storage-key"])]),_:1},8,["items","page","items-per-page","height"]))}}),ve=N({__name:"MusicPlayer",setup(f){return(T,y)=>(P(),b(ae,{variant:"flat"},{default:o(()=>[u(me)]),_:1}))}});export{ve as default};
