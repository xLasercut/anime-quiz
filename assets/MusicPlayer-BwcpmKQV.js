import{d as M,r as v,Q as C,c,e as $,h as y,w as o,f as l,g as k,T as R,U as x,W as G,l as L,t as V,X as Y,a as H,i as B,I as z,u as F,Y as Q,o as W,Z as X,m as T,$ as Z,a0 as w,a1 as J,L as j,k as K,a2 as _,a3 as h,a4 as ee,a5 as D,a6 as q,V as te}from"./index-BQ0TV-HT.js";const ne=M({__name:"MusicPlayerTablePlayerControls",props:{duration:{required:!0,type:Number},currentTime:{required:!0,type:Number},playing:{required:!0,type:Boolean},shuffle:{required:!0,type:Boolean}},emits:["seek","previous","play","pause","next","update:shuffle"],setup(m,{emit:g}){const p=m,f=v(p.currentTime),s=v(!1);C(()=>p.currentTime,n=>{s.value||(f.value=n)});function r(n){return n<3600?new Date(n*1e3).toISOString().substring(14,19):new Date(n*1e3).toISOString().substring(11,16)}return(n,a)=>($(),c(y,null,{default:o(()=>[l(k,{justify:"center"},{default:o(()=>[l(y,{cols:"auto"},{default:o(()=>[l(x,{icon:"mdi-skip-backward",variant:"flat",color:"primary",onClick:a[0]||(a[0]=u=>n.$emit("previous"))})]),_:1}),m.playing?R("",!0):($(),c(y,{key:0,cols:"auto"},{default:o(()=>[l(x,{icon:"mdi-play",variant:"flat",color:"success",onClick:a[1]||(a[1]=u=>n.$emit("play"))})]),_:1})),m.playing?($(),c(y,{key:1,cols:"auto"},{default:o(()=>[l(x,{icon:"mdi-pause",variant:"flat",color:"warning",onClick:a[2]||(a[2]=u=>n.$emit("pause"))})]),_:1})):R("",!0),l(y,{cols:"auto"},{default:o(()=>[l(x,{icon:"mdi-skip-forward",variant:"flat",color:"primary",onClick:a[3]||(a[3]=u=>n.$emit("next"))})]),_:1})]),_:1}),l(k,{justify:"center"},{default:o(()=>[l(y,{cols:"10"},{default:o(()=>[l(G,{min:0,max:m.duration,"model-value":f.value,onMousedown:a[4]||(a[4]=u=>s.value=!0),onMouseup:a[5]||(a[5]=u=>s.value=!1),"hide-details":!0,"thumb-label":!0,"thumb-size":20,color:"warning",onEnd:a[6]||(a[6]=u=>n.$emit("seek",u))},{"thumb-label":o(({modelValue:u})=>[L(V(r(u)),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1}),l(k,{justify:"center"},{default:o(()=>[L(V(r(m.currentTime))+" / "+V(r(m.duration)),1)]),_:1}),l(k,{justify:"center"},{default:o(()=>[l(y,{cols:"auto"},{default:o(()=>[l(Y,{"true-icon":"mdi-shuffle","false-icon":"mdi-shuffle-disabled",color:"info","base-color":"primary",density:"compact","model-value":m.shuffle,"onUpdate:modelValue":a[7]||(a[7]=u=>n.$emit("update:shuffle",u))},null,8,["model-value"])]),_:1})]),_:1})]),_:1}))}}),ae={class:"music-player-container"},le=["src","currentTime","volume"],ue=M({__name:"MusicPlayerTablePlayer",props:{song:{required:!0,type:Object},shuffle:{required:!0,type:Boolean}},emits:["next","previous","play","set-initial-song","update:shuffle"],setup(m,{emit:g}){const p=m,f=g,s=H(),r=v(null),n=v(0),a=v(-1),u=v(!1),S=v(!1),P=v(s.volume);C(()=>s.volume,d=>{P.value=d}),C(()=>S.value,d=>{d&&f("next")});async function E(){r.value.play(),setTimeout(()=>{r.value.volume=s.volume/100},0)}function b(){return s.audioOnly&&p.song.audioSrc?p.song.audioSrc:p.song.src}function N(d){n.value=d.detail.currentTime}function A(d){a.value=d.detail}function U(){p.song.songId?(r.value.volume=s.volume/100,r.value.play()):f("set-initial-song")}function O(){r.value.pause()}return(d,e)=>($(),c(k,{dense:!0},{default:o(()=>[l(y,{cols:"auto"},{default:o(()=>[B("div",ae,[B("media-player",{ref_key:"player",ref:r,autoplay:!1,src:b(),currentTime:n.value,onPause:e[0]||(e[0]=t=>u.value=!1),onPlay:e[1]||(e[1]=t=>u.value=!0),volume:P.value/100,onEnded:e[2]||(e[2]=t=>S.value=!0),onSourceChange:e[3]||(e[3]=t=>S.value=!1),onTimeUpdate:e[4]||(e[4]=t=>N(t)),onDurationChange:e[5]||(e[5]=t=>A(t)),load:"eager",onCanPlay:E},e[12]||(e[12]=[B("media-provider",null,null,-1)]),40,le)])]),_:1}),l(ne,{onSeek:e[6]||(e[6]=t=>n.value=t),"current-time":n.value,duration:a.value,onPause:e[7]||(e[7]=t=>O()),onPlay:e[8]||(e[8]=t=>U()),playing:u.value,onNext:e[9]||(e[9]=t=>d.$emit("next")),onPrevious:e[10]||(e[10]=t=>d.$emit("previous")),shuffle:m.shuffle,"onUpdate:shuffle":e[11]||(e[11]=t=>d.$emit("update:shuffle",t))},null,8,["current-time","duration","playing","shuffle"])]),_:1}))}}),ie=z(ue,[["__scopeId","data-v-7403d58b"]]),re=M({__name:"MusicPlayerTable",setup(m){const g=F(),p=[{title:"Anime",key:"animeName",sortable:!1},{title:"Title",key:"songTitle",sortable:!1},{title:"Artist",key:"artist",sortable:!1},{title:"Type",key:"type",sortable:!1},{title:"Action",key:"action",sortable:!1,width:"60px"}],{currentPage:f,itemsPerPage:s}=Q(j.MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE),r=v({songId:"",src:"",type:q.OP,songTitle:"",artist:"",animeName:[],animeId:[],audioSrc:""}),n=v({anime:"",title:"",artist:"",type:Object.values(q)}),a=v(!0),u=v([]);C(()=>r.value,e=>{const t=u.value.indexOf(e);f.value=Math.floor(t/s.value)+1}),C(()=>[n.value.anime,n.value.title,n.value.artist,n.value.type],()=>{S()});function S(){u.value=g.songList.filter(e=>g.userSongList.includes(e.songId)&&D(n.value.anime,e.animeName.join(","))&&D(n.value.title,e.songTitle)&&D(n.value.artist,e.artist)&&n.value.type.includes(e.type))}function P(e){return r.value.songId===e.songId}function E(e){return P(e)?"primary":"success"}function b(e){const t=Math.floor(Math.random()*e.length);return e[t]}function N(e){if(a.value)return b(e);const t=e.indexOf(r.value);return t>=e.length-1?e[0]:e[t+1]}function A(e){if(a.value)return b(e);const t=e.indexOf(r.value);return t<=0?e[e.length-1]:e[t-1]}function U(){const e=u.value;e.length<=0||(r.value=N(e))}function O(){const e=u.value;e.length<=0||(r.value=A(e))}function d(){const e=u.value;if(!(e.length<=0)){if(a.value){r.value=b(e);return}r.value=e[0]}}return W(()=>{S()}),(e,t)=>($(),c(X,{headers:p,items:u.value,"fixed-header":!0,"fixed-footer":!0,density:"compact",page:T(f),"onUpdate:page":t[10]||(t[10]=i=>w(f)?f.value=i:null),"items-per-page":T(s),height:T(Z).MUSIC_PLAYER_TABLE_HEIGHT,"no-filter":!0},{"item.animeName":o(({item:i})=>[l(ee,{song:i},null,8,["song"])]),"item.action":o(({item:i})=>[l(h,{icon:"mdi-play-box",color:E(i),onClick:I=>r.value=i,disabled:P(i)},null,8,["color","onClick","disabled"])]),top:o(()=>[l(K,{fluid:!0},{default:o(()=>[l(ie,{song:r.value,onNext:t[0]||(t[0]=i=>U()),onPrevious:t[1]||(t[1]=i=>O()),onSetInitialSong:t[2]||(t[2]=i=>d()),shuffle:a.value,"onUpdate:shuffle":t[3]||(t[3]=i=>a.value=i)},null,8,["song","shuffle"]),l(_,{anime:n.value.anime,"onUpdate:anime":t[4]||(t[4]=i=>n.value.anime=i),animeModifiers:{trim:!0},title:n.value.title,"onUpdate:title":t[5]||(t[5]=i=>n.value.title=i),titleModifiers:{trim:!0},artist:n.value.artist,"onUpdate:artist":t[6]||(t[6]=i=>n.value.artist=i),artistModifiers:{trim:!0},type:n.value.type,"onUpdate:type":t[7]||(t[7]=i=>n.value.type=i),typeModifiers:{trim:!0}},null,8,["anime","title","artist","type"])]),_:1})]),bottom:o(({pageCount:i})=>[l(J,{"current-page":T(f),"onUpdate:currentPage":t[8]||(t[8]=I=>w(f)?f.value=I:null),"items-per-page":T(s),"onUpdate:itemsPerPage":t[9]||(t[9]=I=>w(s)?s.value=I:null),length:i,"local-storage-key":T(j).MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE},null,8,["current-page","items-per-page","length","local-storage-key"])]),_:1},8,["items","page","items-per-page","height"]))}}),se=M({__name:"MusicPlayer",setup(m){return(g,p)=>($(),c(te,{variant:"flat"},{default:o(()=>[l(re)]),_:1}))}});export{se as default};
