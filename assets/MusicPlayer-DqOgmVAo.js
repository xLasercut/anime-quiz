import{d as N,r as g,Q as E,f as c,c as b,w as o,g as u,j as S,T as M,U as R,h as C,W as G,n as j,t as V,X as Y,a as H,k as B,p as T,I as z,u as F,Y as Q,Z as L,o as W,$ as X,a0 as Z,a1 as J,m as K,a2 as w,L as q,a3 as _,a4 as h,a5 as ee,a6 as D,V as te}from"./index-DnoG31dZ.js";const ne=N({__name:"MusicPlayerTablePlayerControls",props:{duration:{required:!0,type:Number},currentTime:{required:!0,type:Number},playing:{required:!0,type:Boolean},shuffle:{required:!0,type:Boolean}},emits:["seek","previous","play","pause","next","update:shuffle"],setup(m,{emit:$}){const y=m,d=g(y.currentTime),p=g(!1);E(()=>y.currentTime,t=>{p.value||(d.value=t)});function s(t){return t<3600?new Date(t*1e3).toISOString().substring(14,19):new Date(t*1e3).toISOString().substring(11,16)}return(t,l)=>(c(),b(S,null,{default:o(()=>[u(C,{justify:"center"},{default:o(()=>[u(S,{cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-skip-backward",variant:"flat",color:"primary",onClick:l[0]||(l[0]=i=>t.$emit("previous"))})]),_:1}),m.playing?R("",!0):(c(),b(S,{key:0,cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-play",variant:"flat",color:"success",onClick:l[1]||(l[1]=i=>t.$emit("play"))})]),_:1})),m.playing?(c(),b(S,{key:1,cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-pause",variant:"flat",color:"warning",onClick:l[2]||(l[2]=i=>t.$emit("pause"))})]),_:1})):R("",!0),u(S,{cols:"auto"},{default:o(()=>[u(M,{icon:"mdi-skip-forward",variant:"flat",color:"primary",onClick:l[3]||(l[3]=i=>t.$emit("next"))})]),_:1})]),_:1}),u(C,{justify:"center"},{default:o(()=>[u(S,{cols:"10"},{default:o(()=>[u(G,{min:0,max:m.duration,"model-value":d.value,onMousedown:l[4]||(l[4]=i=>p.value=!0),onMouseup:l[5]||(l[5]=i=>p.value=!1),"hide-details":!0,"thumb-label":!0,"thumb-size":20,color:"warning",onEnd:l[6]||(l[6]=i=>t.$emit("seek",i))},{"thumb-label":o(({modelValue:i})=>[j(V(s(i)),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1}),u(C,{justify:"center"},{default:o(()=>[j(V(s(m.currentTime))+" / "+V(s(m.duration)),1)]),_:1}),u(C,{justify:"center"},{default:o(()=>[u(S,{cols:"auto"},{default:o(()=>[u(Y,{"true-icon":"mdi-shuffle","false-icon":"mdi-shuffle-disabled",color:"info","base-color":"primary",density:"compact","model-value":m.shuffle,"onUpdate:modelValue":l[7]||(l[7]=i=>t.$emit("update:shuffle",i))},null,8,["model-value"])]),_:1})]),_:1})]),_:1}))}}),ae={class:"music-player-container"},le=["src","currentTime","volume"],ue=N({__name:"MusicPlayerTablePlayer",props:{song:{required:!0,type:Object},shuffle:{required:!0,type:Boolean}},emits:["next","previous","play","set-initial-song","update:shuffle"],setup(m,{emit:$}){const y=m,d=$,p=H(),s=g(null),t=g(0),l=g(-1),i=g(!1),P=g(!1);E(()=>P.value,v=>{v&&d("next")});function I(){return p.audioOnly&&y.song.audioSrc?y.song.audioSrc:y.song.src}function A(v){t.value=v.detail.currentTime}function k(v){l.value=v.detail}function U(){y.song.songId?s.value.play():d("set-initial-song")}function O(){s.value.pause()}return(v,a)=>(c(),b(C,{dense:!0},{default:o(()=>[u(S,{cols:"auto"},{default:o(()=>[B("div",ae,[B("media-player",{ref_key:"player",ref:s,autoplay:"",src:I(),currentTime:t.value,onPause:a[0]||(a[0]=f=>i.value=!1),onPlay:a[1]||(a[1]=f=>i.value=!0),volume:T(p).volume/100,onEnded:a[2]||(a[2]=f=>P.value=!0),onSourceChange:a[3]||(a[3]=f=>P.value=!1),onTimeUpdate:a[4]||(a[4]=f=>A(f)),onDurationChange:a[5]||(a[5]=f=>k(f)),load:"eager"},a[12]||(a[12]=[B("media-provider",null,null,-1)]),40,le)])]),_:1}),u(ne,{onSeek:a[6]||(a[6]=f=>t.value=f),"current-time":t.value,duration:l.value,onPause:a[7]||(a[7]=f=>O()),onPlay:a[8]||(a[8]=f=>U()),playing:i.value,onNext:a[9]||(a[9]=f=>v.$emit("next")),onPrevious:a[10]||(a[10]=f=>v.$emit("previous")),shuffle:m.shuffle,"onUpdate:shuffle":a[11]||(a[11]=f=>v.$emit("update:shuffle",f))},null,8,["current-time","duration","playing","shuffle"])]),_:1}))}}),ie=z(ue,[["__scopeId","data-v-2a38658e"]]),re=N({__name:"MusicPlayerTable",setup(m){const $=F(),y=[{title:"Anime",key:"animeName",sortable:!1},{title:"Title",key:"songTitle",sortable:!1},{title:"Artist",key:"artist",sortable:!1},{title:"Type",key:"type",sortable:!1},{title:"Action",key:"action",sortable:!1,width:"60px"}],{currentPage:d,itemsPerPage:p}=Q(q.MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE),s=g({songId:"",src:"",type:L.OP,songTitle:"",artist:"",animeName:[],animeId:[],audioSrc:""}),t=g({anime:"",title:"",artist:"",type:Object.values(L)}),l=g(!0),i=g([]);E(()=>s.value,e=>{const n=i.value.indexOf(e);d.value=Math.floor(n/p.value)+1}),E(()=>[t.value.anime,t.value.title,t.value.artist,t.value.type],()=>{P()});function P(){i.value=$.songList.filter(e=>$.userSongList.includes(e.songId)&&D(t.value.anime,e.animeName.join(","))&&D(t.value.title,e.songTitle)&&D(t.value.artist,e.artist)&&t.value.type.includes(e.type))}function I(e){return s.value.songId===e.songId}function A(e){return I(e)?"primary":"success"}function k(e){const n=Math.floor(Math.random()*e.length);return e[n]}function U(e){if(l.value)return k(e);const n=e.indexOf(s.value);return n>=e.length-1?e[0]:e[n+1]}function O(e){if(l.value)return k(e);const n=e.indexOf(s.value);return n<=0?e[e.length-1]:e[n-1]}function v(){const e=i.value;e.length<=0||(s.value=U(e))}function a(){const e=i.value;e.length<=0||(s.value=O(e))}function f(){const e=i.value;if(!(e.length<=0)){if(l.value){s.value=k(e);return}s.value=e[0]}}return W(()=>{P()}),(e,n)=>(c(),b(ee,{headers:y,items:i.value,"fixed-header":!0,"fixed-footer":!0,density:"compact",page:T(d),"onUpdate:page":n[10]||(n[10]=r=>w(d)?d.value=r:null),"items-per-page":T(p),height:T(h).MUSIC_PLAYER_TABLE_HEIGHT,"no-filter":!0},{"item.animeName":o(({item:r})=>[u(X,{song:r},null,8,["song"])]),"item.action":o(({item:r})=>[u(Z,{icon:"mdi-play-box",color:A(r),onClick:x=>s.value=r,disabled:I(r)},null,8,["color","onClick","disabled"])]),top:o(()=>[u(K,{fluid:!0},{default:o(()=>[u(ie,{song:s.value,onNext:n[0]||(n[0]=r=>v()),onPrevious:n[1]||(n[1]=r=>a()),onSetInitialSong:n[2]||(n[2]=r=>f()),shuffle:l.value,"onUpdate:shuffle":n[3]||(n[3]=r=>l.value=r)},null,8,["song","shuffle"]),u(J,{anime:t.value.anime,"onUpdate:anime":n[4]||(n[4]=r=>t.value.anime=r),animeModifiers:{trim:!0},title:t.value.title,"onUpdate:title":n[5]||(n[5]=r=>t.value.title=r),titleModifiers:{trim:!0},artist:t.value.artist,"onUpdate:artist":n[6]||(n[6]=r=>t.value.artist=r),artistModifiers:{trim:!0},type:t.value.type,"onUpdate:type":n[7]||(n[7]=r=>t.value.type=r),typeModifiers:{trim:!0}},null,8,["anime","title","artist","type"])]),_:1})]),bottom:o(({pageCount:r})=>[u(_,{"current-page":T(d),"onUpdate:currentPage":n[8]||(n[8]=x=>w(d)?d.value=x:null),"items-per-page":T(p),"onUpdate:itemsPerPage":n[9]||(n[9]=x=>w(p)?p.value=x:null),length:r,"local-storage-key":T(q).MUSIC_PLAYER_TABLE_ITEMS_PER_PAGE},null,8,["current-page","items-per-page","length","local-storage-key"])]),_:1},8,["items","page","items-per-page","height"]))}}),se=N({__name:"MusicPlayer",setup(m){return($,y)=>(c(),b(te,{variant:"flat"},{default:o(()=>[u(re)]),_:1}))}});export{se as default};
